#
#  $Id$
#

@SET_MAKE@
srcdir = @srcdir@
top_srcdir = @top_srcdir@
top_builddir = .

RTEMS_ROOT = @RTEMS_ROOT@
PROJECT_ROOT = @PROJECT_ROOT@

VPATH = @srcdir@

include $(RTEMS_ROOT)/make/custom/@RTEMS_BSP@.cfg
include $(RTEMS_ROOT)/make/directory.cfg

INSTALL_CHANGE = @INSTALL_CHANGE@
mkinstalldirs = $(SHELL) $(top_srcdir)/@RTEMS_TOPdir@/mkinstalldirs

INSTALLDIRS = $(PROJECT_RELEASE)/tests/screens/sptests \
    $(PROJECT_RELEASE)/tests/screens/mptests \
    $(PROJECT_RELEASE)/tests/screens/psxtests \
    $(PROJECT_RELEASE)/tests/screens/mptests/node1 \
    $(PROJECT_RELEASE)/tests/screens/mptests/node2 \
    $(PROJECT_RELEASE)/samples

$(INSTALLDIRS):
	@$(mkinstalldirs) $(INSTALLDIRS)

all: README

# mptests are the multiprocessing test suite
# We only build them if HAS_MP was defined
MP_TESTS_yes_V = mptests
MP_TESTS = $(MP_TESTS_$(HAS_MP)_V)

# psxtests are the POSIX API test suite
# We only build them if HAS_POSIX_API was defined
POSIX_TESTS_yes_V = psxtests
POSIX_TESTS = $(POSIX_TESTS_$(HAS_POSIX_API)_V)

# wildcard on this lets ALL test suites be optional
SUB_DIRS = $(wildcard tools support samples libtests sptests $(MP_TESTS) \
    $(POSIX_TESTS) tmtests)

preinstall: $(INSTALLDIRS)

Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
	cd $(top_builddir) \
	 && CONFIG_FILES=$@ CONFIG_HEADERS= $(SHELL) ./config.status
