#
#  $Id$
#
#  build and install "glommed" librtemsall.a
#

@SET_MAKE@
srcdir = @srcdir@
top_srcdir = @top_srcdir@
VPATH = @srcdir@
RTEMS_ROOT = @RTEMS_ROOT@
PROJECT_ROOT = @PROJECT_ROOT@
RTEMS_CUSTOM = $(RTEMS_ROOT)/make/custom/$(RTEMS_BSP).cfg

include $(RTEMS_CUSTOM)
include $(RTEMS_ROOT)/make/lib.cfg
 
LIB=$(PROJECT_RELEASE)/lib/librtemsall.a
 
SRCS=$(wildcard $(PROJECT_RELEASE)/lib/libbsp$(LIB_VARIANT).a) \
     $(PROJECT_RELEASE)/lib/librtems$(LIB_VARIANT).a \
     $(wildcard $(PROJECT_RELEASE)/lib/libposix$(LIB_VARIANT).a) \
     $(wildcard $(PROJECT_RELEASE)/lib/libka9q$(LIB_VARIANT).a) \
     $(PROJECT_RELEASE)/lib/libcsupport$(LIB_VARIANT).a \
     $(PROJECT_RELEASE)/lib/libmisc$(LIB_VARIANT).a \
     $(wildcard $(PROJECT_RELEASE)/lib/rtems-ctor$(LIB_VARIANT).o) \
     $(wildcard $(PROJECT_RELEASE)/lib/libno-ctor$(LIB_VARIANT).a)
 
CLEAN_ADDITIONS +=
CLOBBER_ADDITIONS +=
 
all:    $(ARCH) $(LIB)
 
$(LIB):  $(SRCS)
	PROJECT_RELEASE=$(PROJECT_RELEASE) \
	    $(PROJECT_RELEASE)/build-tools/rtems-glom \
	        -d $(PROJECT_RELEASE)/lib -v -V "$(LIB_VARIANT)" \
	        -a $(AR)
 
install:  all

