#
#  $Id$
#

@SET_MAKE@
srcdir = @srcdir@
VPATH = @srcdir@
RTEMS_ROOT = @top_srcdir@
PROJECT_ROOT = @PROJECT_ROOT@

INSTALL = @INSTALL@

H_PIECES=chain console clockdrv iosupp ringbuf \
   spurious timerdrv vmeintr
H_FILES=$(H_PIECES:%=$(srcdir)/%.h)

SYS_H_PIECES=ioctl termios
SYS_H_FILES=$(SYS_H_PIECES:%=$(srcdir)/sys/%.h)

MOTOROLA_H_PIECES=mc68230 mc68681
MOTOROLA_H_FILES=$(MOTOROLA_H_PIECES:%=$(srcdir)/motorola/%.h)

ZILOG_H_PIECES=z8036 z8530 z8536
ZILOG_H_FILES=$(ZILOG_H_PIECES:%=$(srcdir)/zilog/%.h)

RTEMSCPLUSPLUS_H_PIECES= rtemsEvent rtemsInterrupt rtemsMessageQueue \
  rtemsSemaphore rtemsStatusCode rtemsTask rtemsTaskMode rtemsTimer
RTEMSCPLUSPLUS_H_FILES=$(RTEMSCPLUSPLUS_H_PIECES:%=$(srcdir)/rtems++/%.h)

RPC_H_PIECES=  auth clnt rpc rpc_msg svc svc_auth types xdr
RPC_H_FILES=$(RPC_H_PIECES:%=$(srcdir)/rpc/%.h)

# We only build the rdbg library if HAS_NETWORKING and HAS_RDBG was defined
RDBG_H_PIECES_yes_yes_V = servrpc rdbg $(RTEMS_CPU)/rdbg_f $(RTEMS_CPU)/reg
RDBG_H_FILES=$(RDBG_H_PIECES_$(HAS_NETWORKING)_$(HAS_RDBG)_V:%=$(srcdir)/rdbg/%.h)

SRCS=$(H_FILES) $(SYS_H_FILES) \
     $(MOTOROLA_H_FILES) $(RTEMSCPLUSPLUS_H_FILES) \
     $(RPC_H_FILES) $(RDBG_H_FILES)

include $(RTEMS_ROOT)/make/custom/$(RTEMS_BSP).cfg
include $(RTEMS_ROOT)/make/leaf.cfg
CLEAN_ADDITIONS +=
CLOBBER_ADDITIONS +=

all:	$(SRCS)
	$(INSTALL_CHANGE) -m 444 $(H_FILES) $(PROJECT_INCLUDE)
	$(INSTALL_CHANGE) -m 444 $(SYS_H_FILES) $(PROJECT_INCLUDE)/sys
	$(INSTALL_CHANGE) -m 444 $(MOTOROLA_H_FILES) \
            $(PROJECT_INCLUDE)/motorola
	$(INSTALL_CHANGE) -m 444 $(ZILOG_H_FILES) $(PROJECT_INCLUDE)/zilog
ifeq ($(HAS_CPLUSPLUS),yes)
	$(INSTALL_CHANGE) -m 444 $(RTEMSCPLUSPLUS_H_FILES) $(PROJECT_INCLUDE)/rtems++
endif
ifeq ($(HAS_NETWORKING),yes)
	$(INSTALL_CHANGE) -m 444 $(RPC_H_FILES) $(PROJECT_INCLUDE)/rpc
ifeq ($(HAS_RDBG),yes)
	$(INSTALL_CHANGE) -m 444 $(RDBG_H_FILES) $(PROJECT_INCLUDE)/rdbg
endif
endif
